---
id: adr-0001
sidebar_position: 1
---

# ADR-0001: 初期アーキテクチャ設計

## Status
**Accepted** - 2025/12/14

## Context

Strata は、「途中の思考や迷いを、そのまま残す」ことを目的とした個人向けツールである。

本プロダクトでは、以下のような前提条件があった。

- 思考や独白は **公開や完成を前提としない**
- 人生・行動の途中にある思考を **低い心理的負荷で記録できる**ことが重要
- データは個人の内面に強く紐づくため、**ローカルファースト**であることが望ましい
- 将来的に AI による振り返りや整理をサポートする
- PCで作業中も、外出中のスマホからでも、ふと思いついたことを入力したい
- 個人開発かつ MVP フェーズであり、**開発速度と設計の説明可能性**を重視したい

これらを踏まえ、初期アーキテクチャを決定する必要があった。

---

## Decision

### 1. デスクトップアプリを起点とし、Tauri を採用する

Strata の初期実装は **Tauri を用いたデスクトップアプリ**とする。

- OS ネイティブなウィンドウ・常駐性・ショートカットとの親和性が高い
- Web 技術（HTML/CSS/TypeScript）を用いて UI を構築できる
- Electron に比べて軽量で、個人ツールとしての“静かさ”に適している
- 将来的に Web/PWA 展開する場合も、UI やロジックの再利用が可能

---

### 2. ローカルファーストを前提とし、サーバー同期は初期スコープから外す

Strata では、以下を理由に **初期段階でサーバーを持たない**判断をした。

- 思考ログは極めて個人的であり、常時クラウド同期は必須ではない
- 認証・暗号化・運用といったセキュリティコストが MVP に対して過剰
- 同期は「必要になった時点で設計できる問題」であり、初期価値ではない

そのため、データは端末ローカルに保存し、  
将来的な同期は **設計上の余地として残す**に留める。

---

### 3. MVP では IndexedDB を用い、体験を優先する

初期 MVP では、以下の理由から **SQLite を急いで導入せず IndexedDB を利用する**。

- まずは「書ける・残る・見返せる」という体験を最短で作る
- Web 技術ベースの UI からそのまま扱え、セットアップが軽い
- スキーマ設計やマイグレーションは、体験が固まってからで十分
- 保存方式は後から差し替え可能であるべき

そのため、MVP では IndexedDB を用いたローカル永続化とし、  
体験評価後に SQLite への移行を検討する。

---

### 4. モノレポ構成を採用し、境界を意識した設計にする

Strata は以下の構成を想定した **モノレポ**とする。

- `apps/desktop`：Tauri デスクトップアプリ
- `packages/core`：ドメイン・ユースケース（ランタイム非依存）

パッケージ管理には **pnpm workspace** を採用する。

- 将来の Web/PWA 追加を見据え、依存関係を明確にしたい
- ランタイム依存（OS・ストレージ・AI）と、ドメインロジックを分離したい

---

### 5. UI は「ダッシュボード + 小窓 + タイムライン」の最小構成とする

初期 UX は以下の 3 画面に限定する。

- ダッシュボード：起点となるホーム（ランチャー）
- 小窓：ショートカットで即座に開き、今考えていることを入力したり AI に相談できる軽量な入力窓
- タイムライン：過去の独白を振り返る

分析・可視化・AI要約などは **初期スコープから除外**し、  
入力の気楽さを最優先とする。AI は小窓からの軽い相談・補助に限定し、要約・分析は後続で検討する。

---

## Consequences

### 良い点

- 最小構成で「Strataらしい体験」を早期に確認できる
- ローカルファーストかつ低負荷な設計になる
- 将来の Web/PWA・同期・AI 拡張に対して構造的な余地がある
- 設計判断の理由を説明しやすく、ポートフォリオとして有効

### トレードオフ

- マルチデバイス同期は初期段階では提供されない
- 保存方式（IndexedDB → SQLite）の移行作業が後から発生する
- 初期状態では分析的な価値は限定的

---

## Notes

本 ADR は、MVP フェーズにおける判断を記録したものであり、  
ユーザー数・用途・セキュリティ要件の変化に応じて更新される可能性がある。

特に以下は、将来の再検討対象である。

- データ同期方式
- ストレージ実装の抽象化
- AI コンテキスト生成の扱い
